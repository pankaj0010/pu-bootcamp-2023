Implement a generic producer consumer which can
take in a generic input type.